<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Untuk Nadya Putri</title>
<style>
  :root{
    --bg1:#fff0f8; --bg2:#ffe6f0; --accent:#ff4fa5; --deep:#ff007c;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
  body{
    background: radial-gradient(800px 500px at 15% 15%, rgba(255,105,180,0.08), transparent),
                radial-gradient(700px 500px at 90% 90%, rgba(255,40,120,0.06), transparent),
                linear-gradient(180deg,var(--bg1),var(--bg2));
    overflow:hidden;
    color:#222;
  }

  /* canvas layers fill */
  canvas{position:fixed; left:0; top:0; width:100%; height:100%; display:block; pointer-events:none;}

  /* top UI */
  .ui {
    position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); width: min(980px,96vw);
    max-width:980px; background:rgba(255,255,255,0.9); border-radius:18px; padding:18px;
    box-shadow:0 18px 60px rgba(0,0,0,0.12); display:flex; gap:16px; align-items:center;
  }
  .photo {
    width:160px; height:160px; border-radius:50%; object-fit:cover;
    box-shadow: 0 8px 40px rgba(255,0,140,0.12); border:6px solid rgba(255,255,255,0.7);
    flex: 0 0 160px;
  }
  .meta {flex:1; min-width:0;}
  .meta h1{margin:0;font-size:20px; letter-spacing:0.6px; color:var(--deep)}
  .meta .from{margin-top:6px;color:#555;font-size:13px}
  .message {
    margin-top:10px; padding:12px; background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.45));
    border-radius:12px; min-height:96px; font-size:15px; line-height:1.5; color:#222; overflow:hidden;
  }
  .controls{margin-top:12px; display:flex; gap:8px; align-items:center}
  button{cursor:pointer;border-radius:10px;padding:8px 12px;border:0;font-weight:700}
  .btn-main{background:linear-gradient(180deg,var(--deep),var(--accent)); color:#fff; box-shadow:0 8px 28px rgba(255,77,150,0.18)}
  .btn-ghost{background:transparent;border:1px solid rgba(0,0,0,0.08); color:#333}
  .neon-name{position:fixed; left:50%; transform:translateX(-50%); bottom:22px; font-weight:800; letter-spacing:4px;
    color:var(--deep); text-shadow:0 0 22px rgba(255,0,140,0.9), 0 0 50px rgba(255,0,140,0.25); font-size:20px}
  .hint{position:fixed; right:14px; top:12px; font-size:12px; color:#444}
  @media(max-width:720px){
    .ui{flex-direction:column; align-items:center;padding:14px}
    .photo{width:120px;height:120px}
    .meta h1{font-size:18px}
    .message{font-size:14px}
    .neon-name{font-size:16px}
  }
</style>
</head>
<body>

<!-- canvases: order matters (back to front) -->
<canvas id="bgCanvas"></canvas>       <!-- ambient hearts / rain -->
<canvas id="mainCanvas"></canvas>     <!-- particles / explosions / heart-trail -->
<canvas id="textCanvas"></canvas>     <!-- for form-name & sampling -->

<!-- UI card -->
<div class="ui" role="region" aria-label="Love Gift Card">
  <img id="photo" class="photo" alt="Foto Nadya" src="https://i.ibb.co/7QY1fTf/couple.jpg">
  <div class="meta">
    <h1>Untuk: NADYA PUTRI <span style="font-size:20px;margin-left:8px">❤️</span></h1>
    <div class="from">Dari: Rifki</div>

    <div class="message" id="messageBox" aria-live="polite"></div>

    <div class="controls">
      <button id="loveBtn" class="btn-main"> ❤️</button>
      <button id="playBtn" class="btn-ghost">Play Musik</button>
      <button id="pauseBtn" class="btn-ghost" style="display:none">Pause</button>
      <button id="downloadBtn" class="btn-ghost">Download HTML</button>
      <div style="flex:1"></div>
      <div style="font-size:12px;color:#666">Ketuk layar untuk efek hati</div>
    </div>
  </div>
</div>

<div class="neon-name" id="neonName" style="display: none;"></div>
<div class="hint">Tip: Tekan "❤️" untuk efek spesial ✨</div>

<!-- audio element -->
<audio id="bgm" loop preload="auto"></audio>

<script>
/* ================= SETTINGS ================== */
const TO_NAME = "NADYA PUTRI";
const FROM_NAME = "Rifki";
const PHOTO = "https://i.imgur.com/ARw8LdZ.jpeg";
const AUDIO = "https://files.catbox.moe/99090j.mp3"; // place music.mp3 in same folder or change to online link
const MESSAGE = `Hai, ini bulan kelahiranmu. BERBAHAGIALAH, jaga kesehatanmu, jaga pola makanmu, mulailah rutin berolahraga, mulailah untuk memperlakukan dirimu dengan sebaik mungkin dan semangatlah untuk bertahan hidup agar apa yang engkau harapkan dapat terwujud. — ${FROM_NAME}`;
/* ============================================ */

const photo = document.getElementById('photo');
photo.src = PHOTO;
document.getElementById('neonName');


// typewriter into messageBox
const messageBox = document.getElementById('messageBox');
function typeWriter(text, el, speed=20){
  el.textContent = "";
  let i=0;
  const t = setInterval(()=>{ el.textContent += text.charAt(i); i++; if(i>=text.length) clearInterval(t); }, speed);
}
typeWriter(MESSAGE, messageBox, 20);

// audio
const bgm = document.getElementById('bgm');
bgm.src = AUDIO;
bgm.volume = 0.6;
const playBtn = document.getElementById('playBtn');
const pauseBtn = document.getElementById('pauseBtn');
playBtn.addEventListener('click', ()=>{ bgm.play().catch(()=>{}); playBtn.style.display='none'; pauseBtn.style.display='inline-block'; });
pauseBtn.addEventListener('click', ()=>{ bgm.pause(); pauseBtn.style.display='none'; playBtn.style.display='inline-block'; });

// download HTML
document.getElementById('downloadBtn').addEventListener('click', ()=>{
  const html = '<!doctype html>\\n' + document.documentElement.outerHTML;
  const blob = new Blob([html], {type:'text/html'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = `love_for_${TO_NAME.replace(/\s+/g,'_').toLowerCase()}.html`;
  document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
});

/* ================ Canvas Setup ================ */
const bgCanvas = document.getElementById('bgCanvas');
const mainCanvas = document.getElementById('mainCanvas');
const textCanvas = document.getElementById('textCanvas');
const bgCtx = bgCanvas.getContext('2d');
const ctx = mainCanvas.getContext('2d');
const tctx = textCanvas.getContext('2d');

let W = innerWidth, H = innerHeight;
function resize(){
  W = innerWidth; H = innerHeight;
  [bgCanvas, mainCanvas, textCanvas].forEach(c=>{ c.width = W; c.height = H; });
}
resize();
addEventListener('resize', resize);

/* util */
const rand = (a,b)=> Math.random()*(b-a)+a;
const TAU = Math.PI*2;

/* ========== Heart shape (path) ========== */
function drawHeartPath(ctx, x, y, size){
  const s = size/20;
  ctx.beginPath();
  ctx.moveTo(x, y - 8*s);
  ctx.bezierCurveTo(x + 12*s, y - 32*s, x + 55*s, y - 18*s, x + 55*s, y + 8*s);
  ctx.bezierCurveTo(x + 55*s, y + 42*s, x + 28*s, y + 62*s, x, y + 80*s);
  ctx.bezierCurveTo(x - 28*s, y + 62*s, x - 55*s, y + 42*s, x - 55*s, y + 8*s);
  ctx.bezierCurveTo(x - 55*s, y - 18*s, x - 12*s, y - 32*s, x, y - 8*s);
  ctx.closePath();
}

/* ========== Particles ========== */
class Particle {
  constructor(x,y,vx,vy,size,color,char){
    this.x=x; this.y=y; this.vx=vx; this.vy=vy; this.size=size; this.color=color; this.char=char||'❤';
    this.life = rand(60,120); this.ttl=this.life; this.rot = rand(0,TAU);
  }
  update(dt){
    this.vy += 0.04*dt; // gravity
    this.vx *= 0.998;
    this.vy *= 0.998;
    this.x += this.vx*dt;
    this.y += this.vy*dt;
    this.ttl -= dt;
  }
  draw(ctx){
    if(this.ttl<=0) return;
    ctx.save();
    const alpha = Math.max(0, this.ttl/this.life);
    ctx.globalAlpha = alpha;
    ctx.translate(this.x, this.y);
    ctx.rotate(this.rot);
    ctx.font = `${this.size}px serif`;
    ctx.fillStyle = this.color;
    ctx.fillText(this.char, 0, 0);
    ctx.restore();
  }
}
let particles = [];

/* spawn explosion hearts */
function spawnExplosion(x,y,count=40,spread=6){
  for(let i=0;i<count;i++){
    const a = rand(0,TAU);
    const s = rand(1,spread);
    const vx = Math.cos(a)*s*rand(1,3);
    const vy = Math.sin(a)*s*rand(1,3);
    const p = new Particle(x, y, vx, vy, rand(10,28), `rgba(255, ${Math.floor(rand(80,160))}, ${Math.floor(rand(120,250))},1)`);
    particles.push(p);
  }
}

/* heart rain ambient */
let rainAccumulator = 0;
function updateRain(dt){
  rainAccumulator += dt;
  if(rainAccumulator > 18){
    rainAccumulator = 0;
    const x = rand(10, W-10);
    const p = new Particle(x, -20, rand(-0.3,0.3), rand(0.5,1.6), rand(10,22), 'rgba(255,80,160,0.9)','❤');
    particles.push(p);
  }
}

/* cursor-follow hearts (trail) */
let mouse = {x:W/2, y:H/2, down:false};
addEventListener('pointermove', (e)=>{ mouse.x = e.clientX; mouse.y = e.clientY; });
addEventListener('pointerdown', (e)=>{ mouse.down = true; spawnExplosion(e.clientX, e.clientY, 24, 5); });
addEventListener('pointerup', ()=>{ mouse.down = false; });

/* spawn trail */
let trailTimer = 0;

/* ========== Name formation from text ========== */
function formName(name){
  // draw name on textCanvas offscreen with large font, sample pixels
  const hw = W; const hh = 220;
  textCanvas.width = hw; textCanvas.height = hh;
  tctx.clearRect(0,0,hw,hh);
  tctx.fillStyle = 'rgba(0,0,0,0)';
  const fsize = Math.min(220, Math.floor(hw / Math.max(6, name.length)));
  tctx.font = `bold ${fsize}px Inter, sans-serif`;
  tctx.textAlign = 'center';
  tctx.textBaseline = 'middle';
  tctx.fillText(name, hw/2, hh/2);
  const img = tctx.getImageData(0,0,hw,hh).data;
  const step = 8;
  const targets = [];
  for(let y=0;y<hh;y+=step){
    for(let x=0;x<hw;x+=step){
      const idx = (y*hw + x)*4;
      if(img[idx+3] > 128){
        // map to screen y near center
        targets.push({x: x, y: (H*0.46) + (y - hh/2)});
      }
    }
  }
  // create flying hearts
  const centerX = W/2, centerY = H/2;
  for(let i=0;i<Math.min(320, targets.length); i++){
    const t = targets[i];
    const p = new Particle(centerX, centerY, (t.x-centerX)/40 + rand(-1,1), (t.y-centerY)/40 + rand(-1,1), rand(8,18), `rgba(255,${Math.floor(rand(60,180))},${Math.floor(rand(100,255))},1)`);
    // give long life so they reach destination slower
    p.life = 140 + rand(20,60);
    p.ttl = p.life;
    // overwrite update to move to target smoothly
    p.update = function(dt){
      // ease toward target
      this.x += (t.x - this.x) * 0.06 * dt;
      this.y += (t.y - this.y) * 0.06 * dt;
      this.ttl -= dt;
    }
    particles.push(p);
  }
}

/* animation loop */
let last = performance.now();
function loop(now){
  const dt = Math.min(40, (now - last))/16.666; // normalize to ~60fps
  last = now;

  // background clear
  bgCtx.clearRect(0,0,W,H);
  // subtle gradient overlay (bokeh-ish)
  const g = bgCtx.createLinearGradient(0,0,0,H);
  g.addColorStop(0, 'rgba(255,240,250,0.28)');
  g.addColorStop(1, 'rgba(255,230,240,0.2)');
  bgCtx.fillStyle = g;
  bgCtx.fillRect(0,0,W,H);

  // main particles update
  ctx.clearRect(0,0,W,H);
  // spawn trail if mouse moving
  trailTimer += dt;
  if(trailTimer > 1.5){
    trailTimer = 0;
    const count = mouse.down ? 3 : 1;
    for(let i=0;i<count;i++){
      const px = mouse.x + rand(-8,8);
      const py = mouse.y + rand(-8,8);
      const p = new Particle(px, py, rand(-0.5,0.5), rand(-1.6,-0.6), rand(8,20), `rgba(255,${Math.floor(rand(60,180))},${Math.floor(rand(100,255))},1)`);
      particles.push(p);
    }
  }

  updateRain(dt);

  // update & draw particles
  for(let i=particles.length-1;i>=0;i--){
    const p = particles[i];
    p.update(dt);
    if(p.ttl <= 0 || p.y > H + 80 || p.x < -80 || p.x > W + 80) particles.splice(i,1);
    else p.draw(ctx);
  }

  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* small click floating hearts as DOM for better crispness */
function spawnFloatingHeart(x,y){
  const el = document.createElement('div');
  el.textContent = '❤';
  el.style.position = 'fixed';
  el.style.left = (x - 10) + 'px';
  el.style.top = (y - 10) + 'px';
  el.style.fontSize = '20px';
  el.style.pointerEvents = 'none';
  el.style.transition = 'transform 900ms cubic-bezier(.2,.9,.3,1), opacity 900ms linear';
  el.style.transform = 'translateY(0) scale(1)';
  el.style.opacity = '1';
  document.body.appendChild(el);
  requestAnimationFrame(()=> {
    el.style.transform = `translateY(-120px) scale(1.6)`;
    el.style.opacity = '0';
  });
  setTimeout(()=> el.remove(), 1000);
}

/* listen taps to spawn floating hearts & explosions */
addEventListener('pointerdown', (e)=>{
  spawnFloatingHeart(e.clientX, e.clientY);
  spawnExplosion(e.clientX, e.clientY, 28, 5);
});

/* special button: big explosion + name form */
const loveBtn = document.getElementById('loveBtn');
loveBtn.addEventListener('click', ()=>{
  // big center flash + explosion
  const cx = W/2, cy = H/2;
  spawnExplosion(cx, cy, 120, 8);
  // smaller rings
  for(let i=0;i<6;i++) spawnExplosion(rand(W*0.3,W*0.7), rand(H*0.25,H*0.6), 40, 6);
  // form name
  formName(TO_NAME.toUpperCase());
});

/* gentle ambient explosions every few seconds */
setInterval(()=>{ spawnExplosion(rand(60,W-60), rand(60,H-100), 8, 3); }, 2200);

/* initial small burst */
setTimeout(()=> spawnExplosion(W/2, H/2, 36, 5), 600);

/* ensure pointer interactions on mobile show hearts (some mobile needs touch) */
['touchstart','touchmove'].forEach(evt=>{
  addEventListener(evt,(e)=>{
    const t = e.touches ? e.touches[0] : e;
    spawnFloatingHeart(t.clientX, t.clientY);
  }, {passive:true});
});
</script>
</body>
</html>
